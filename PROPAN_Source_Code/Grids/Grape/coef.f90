!-----------------------------------------------------------------------------------------------!
SUBROUTINE COEF(XL,YL,DXDL,DYDL,RL,NP)
!-----------------------------------------------------------------------------------------------!
IMPLICIT NONE
INTEGER :: I,IM,IP,NP,NPM1,NDIM
PARAMETER(NDIM=150)
DOUBLE PRECISION :: DIV,AQ(NDIM)
DOUBLE PRECISION :: XL(NP),YL(NP),DXDL(NP),DYDL(NP),RL(NP)
!-----------------------------------------------------------------------------------------------!
DXDL(1)=3.D0*(XL(2)-XL(1))
DYDL(1)=3.D0*(YL(2)-YL(1))
AQ(1)  =2.D0
DO I=2,NP
   IM=I-1
   IP=MIN(I+1,NP)
!-----------------------------------------------------------------------------------------------!
   DIV=-1.D0/AQ(IM)
   AQ(I)=4.D0+DIV
   DXDL(I)=3.D0*(XL(IP)-XL(IM))+DIV*DXDL(IM)
   DYDL(I)=3.D0*(YL(IP)-YL(IM))+DIV*DYDL(IM)
END DO !I=2,NP
AQ(NP)=AQ(NP)-2.D0
!-----------------------------------------------------------------------------------------------!
DXDL(NP)=DXDL(NP)/AQ(NP)
DYDL(NP)=DYDL(NP)/AQ(NP)
NPM1=NP-1
DO I=NPM1,1,-1
   IP=I+1
   DXDL(I)=(DXDL(I)-DXDL(IP))/AQ(I)
   DYDL(I)=(DYDL(I)-DYDL(IP))/AQ(I)
   RL(I)=DFLOAT(I)
END DO !I=NPM1,1,-1
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE COEF
!-----------------------------------------------------------------------------------------------!