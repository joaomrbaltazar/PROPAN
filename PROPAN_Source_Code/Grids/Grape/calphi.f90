!-----------------------------------------------------------------------------------------------!
SUBROUTINE CALPHI(PHI,DPH,D2P,XL)
!-----------------------------------------------------------------------------------------------!
IMPLICIT NONE
DOUBLE PRECISION :: XL,XL2
DOUBLE PRECISION :: PHI(4),DPH(4),D2P(4)
!-----------------------------------------------------------------------------------------------!
XL2   =XL*XL
PHI(1)=XL2*(2.D0*XL-3.D0)+1.D0
PHI(2)=XL2*(3.D0-2.D0*XL)
PHI(3)=XL2*(XL-2.D0)+XL
PHI(4)=XL2*(XL-1.D0)
!-----------------------------------------------------------------------------------------------!
DPH(1)=6.D0*XL*(XL-1.D0)
DPH(2)=6.D0*XL*(1.D0-XL)
DPH(3)=XL*(3.D0*XL-4.D0)+1.D0
DPH(4)=XL*(3.D0*XL-2.D0)
!-----------------------------------------------------------------------------------------------!
D2P(1)= 12.D0*XL-6.D0
D2P(2)=-12.D0*XL+6.D0
D2P(3)=  6.D0*XL-4.D0
D2P(4)=  6.D0*XL-2.D0
!-----------------------------------------------------------------------------------------------!
END SUBROUTINE CALPHI
!-----------------------------------------------------------------------------------------------!